!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rextagtext=e():t.rextagtext=e()}(window,function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=135)}({0:function(t,e,s){"use strict";e.a={hleft:0,hcenter:1,hright:2,vtop:0,vcenter:1,vbottom:2,NO_NEWLINE:0,RAW_NEWLINE:1,WRAPPED_NEWLINE:2,NO_WRAP:0,WORD_WRAP:1,CHAR_WRAP:2,SPLITREGEXP:/(?:\r\n|\r|\n)/}},135:function(t,e,s){"use strict";s.r(e);var n=s(56);const i=Phaser.Utils.Objects.GetAdvancedValue,r=Phaser.GameObjects.BuildGameObject;Phaser.GameObjects.GameObjectFactory.register("rexTagText",function(t,e,s,i){s=new n.a(this.scene,t,e,s,i);return this.displayList.add(s),s}),Phaser.GameObjects.GameObjectCreator.register("rexTagText",function(t,e){var s=i(t,"text",""),a=i(t,"style",null),o=i(t,"padding",null);null!==o&&(a.padding=o),void 0!==e&&(t.add=e);var h=new n.a(this.scene,0,0,s,a);return r(this.scene,h,t),h.autoRound=i(t,"autoRound",!0),h.resolution=i(t,"resolution",1),h}),e.default=n.a},24:function(t,e,s){"use strict";const n=Phaser.Display.Canvas.CanvasPool;var i={},r=function(t){var e=n.create(this),s=e.getContext("2d");t.syncFont(e,s);var r=Math.ceil(s.measureText(t.testString).width*t.baselineX),a=r,o=2*a;a=a*t.baselineY|0,e.width=r,e.height=o,s.fillStyle="#f00",s.fillRect(0,0,r,o),s.font=t._font,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(t.testString,0,a);var h=i;if(!s.getImageData(0,0,r,o))return h.ascent=a,h.descent=a+6,h.fontSize=h.ascent+h.descent,n.remove(e),h;var l,d,u=s.getImageData(0,0,r,o).data,f=u.length,c=4*r,p=0,g=!1;for(l=0;l<a;l++){for(d=0;d<c;d+=4)if(255!==u[p+d]){g=!0;break}if(g)break;p+=c}for(h.ascent=a-l,p=f-c,g=!1,l=o;l>a;l--){for(d=0;d<c;d+=4)if(255!==u[p+d]){g=!0;break}if(g)break;p-=c}return h.descent=l-a,h.fontSize=h.ascent+h.descent,n.remove(e),h},a=s(0);const o=Phaser.Utils.Objects.GetAdvancedValue,h=Phaser.Utils.Objects.GetValue;var l={backgroundColor:["backgroundColor",null],fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],underlineColor:["underline.color","#000"],underlineThickness:["underline.thickness",0],underlineOffset:["underline.offset",0],halign:["halign",0],valign:["valign",0],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],lineSpacing:["lineSpacing",0],rtl:["rtl",!1],testString:["testString","|MÃ‰qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wrapMode:["wrap.mode",0],wrapWidth:["wrap.width",null]};const d={left:a.a.hleft,center:a.a.hcenter,right:a.a.hright},u={top:a.a.vtop,center:a.a.vcenter,bottom:a.a.vbottom},f={none:a.a.NO_WRAP,word:a.a.WORD_WRAP,char:a.a.CHAR_WRAP,character:a.a.CHAR_WRAP};e.a=class{constructor(t,e){this.parent=t,this.backgroundColor,this.fontFamily,this.fontSize,this.fontStyle,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.underlineColor,this.underlineThickness,this.underlineOffset,this.halign,this.valign,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.lineSpacing,this.rtl,this.testString,this.baselineX,this.baselineY,this._font,this.setStyle(e,!1);var s=h(e,"metrics",!1);this.metrics=s?{ascent:h(s,"ascent",0),descent:h(s,"descent",0),fontSize:h(s,"fontSize",0)}:r(this)}setStyle(t,e){if(void 0===e&&(e=!0),t&&t.hasOwnProperty("halign")&&"string"==typeof t.halign&&(t.halign=d[t.halign.toLowerCase()]||0),t&&t.hasOwnProperty("valign")&&"string"==typeof t.valign&&(t.valign=u[t.valign.toLowerCase()]||0),t&&t.hasOwnProperty("wrap")){var s=t.wrap;if(s.hasOwnProperty("mode")){var n=s.mode;"string"==typeof n&&(s.mode=f[n.toLowerCase()]||0)}else s.hasOwnProperty("width")&&(s.mode=1)}for(var i in t&&t.hasOwnProperty("fontSize")&&"number"==typeof t.fontSize&&(t.fontSize=t.fontSize.toString()+"px"),l)this[i]="wrapCallback"===i||"wrapCallbackScope"===i?h(t,l[i][0],l[i][1]):o(t,l[i][0],l[i][1]);var r=h(t,"font",null);this._font=null===r?this.fontStyle+" "+this.fontSize+" "+this.fontFamily:r;var a=h(t,"fill",null);return null!==a&&(this.color=a),e?this.update(!0):this.parent}syncFont(t,e){e.font=this._font}syncStyle(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"}syncShadow(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)}update(t){return t&&(this._font=this.fontStyle+" "+this.fontSize+" "+this.fontFamily,this.metrics=r(this)),this.parent.updateText(t)}buildFont(){var t=this.fontStyle+" "+this.fontSize+" "+this.fontFamily;return t!==this._font&&(this._font=t),this}setFont(t){return"string"==typeof t?(this.fontFamily=t,this.fontSize="",this.fontStyle=""):(this.fontFamily=h(t,"fontFamily","Courier"),this.fontSize=h(t,"fontSize","16px"),this.fontStyle=h(t,"fontStyle","")),this.update(!0)}setFontFamily(t){return this.fontFamily=t,this.update(!0)}setFontStyle(t){return this.fontStyle=t,this.update(!0)}setFontSize(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize=t,this.update(!0)}setTestString(t){return this.testString=t,this.update(!0)}setFixedSize(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)}setResolution(t){return this.resolution=t,this.update(!1)}setLineSpacing(t){return this.lineSpacing=t,this.update(!1)}setBackgroundColor(t){return this.backgroundColor=t,this.update(!1)}setFill(t){return this.color=t,this.update(!1)}setColor(t){return this.color=t,this.update(!1)}setStroke(t,e){return void 0===t?this.strokeThickness=0:(void 0===e&&(e=this.strokeThickness),this.stroke=t,this.strokeThickness=e),this.update(!0)}setShadow(t,e,s,n,i,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===s&&(s="#000"),void 0===n&&(n=0),void 0===i&&(i=!1),void 0===r&&(r=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=s,this.shadowBlur=n,this.shadowStroke=i,this.shadowFill=r,this.update(!1)}setShadowOffset(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)}setShadowColor(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)}setShadowBlur(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)}setShadowStroke(t){return this.shadowStroke=t,this.update(!1)}setShadowFill(t){return this.shadowFill=t,this.update(!1)}setUnderline(t,e,s){return void 0===t&&(t="#000"),void 0===e&&(e=0),void 0===s&&(s=0),this.underlineColor=t,this.underlineThickness=e,this.underlineOffset=s,this.update(!1)}setUnderlineColor(t){return void 0===t&&(t="#000"),this.underlineColor=t,this.update(!1)}setUnderlineThickness(t){return void 0===t&&(t=0),this.underlineThickness=t,this.update(!1)}setUnderlineOffset(t){return void 0===t&&(t=0),this.underlineOffset=t,this.update(!1)}setWrapMode(t){return"string"==typeof t&&(t=f[t.toLowerCase()]||0),this.wrapMode=t,this.update(!0)}setWrapWidth(t){this.wrapWidth=t;var e=0!==this.wrapMode;return this.update(e)}setAlign(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),"string"==typeof t&&(t=d[t.toLowerCase()]||0),"string"==typeof e&&(e=d[e.toLowerCase()]||0),this.halign=t,this.valign=e,this.update(!1)}setHAlign(t){return void 0===t&&(t=0),"string"==typeof t&&(t=d[t.toLowerCase()]||0),this.halign=t,this.update(!1)}setVAlign(t){return void 0===t&&(t=0),"string"==typeof t&&(t=d[t.toLowerCase()]||0),this.valign=t,this.update(!1)}setMaxLines(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)}getTextMetrics(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}}get lineHeight(){return this.metrics.fontSize+this.strokeThickness+this.lineSpacing}toJSON(){var t={};for(var e in l)t[e]=this[e];return t.metrics=this.getTextMetrics(),t}destroy(){this.parent=void 0}}},3:function(t,e,s){"use strict";e.a=function(){}},4:function(t,e,s){"use strict";e.a=function(t){if(Array.isArray(t))t.length=0;else for(var e in t)delete t[e]}},44:function(t,e,s){"use strict";const n=Phaser.Renderer.WebGL.Utils;var i=function(t,e,s,i,r){if(""!==e.text){var a=e.frame,o=a.width,h=a.height,l=n.getTintAppendFloatAlpha;this.pipeline.batchTexture(e,a.glTexture,o,h,e.x,e.y,o/e.style.resolution,h/e.style.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,o,h,l(e._tintTL,i.alpha*e._alphaTL),l(e._tintTR,i.alpha*e._alphaTR),l(e._tintBL,i.alpha*e._alphaBL),l(e._tintBR,i.alpha*e._alphaBR),e._isTinted&&e.tintFill,0,0,i,r)}},r=function(t,e,s,n,i){""!==e.text&&t.batchSprite(e,e.frame,n,i)},a=s(3),o=(a.a,a.a,{renderWebGL:i,renderCanvas:r}),h=s(24),l=s(9),d=s(0);const u=Phaser.Utils.Objects.GetValue,f=d.a.NO_NEWLINE,c=d.a.RAW_NEWLINE;var p=class{constructor(t){this.prop={},this.resetFromJSON(t)}resetFromJSON(t){this.text=u(t,"text",""),this.x=u(t,"x",0),this.y=u(t,"y",0),this.width=u(t,"width",0);var e=u(t,"prop",null);null===e&&(e={}),this.prop=e,this.newLineMode=u(t,"newLineMode",0),this.startIndex=u(t,"startIndex",0)}get rawText(){var t=this.text;return this.newLineMode===c&&(t+="\n"),t}get wrapText(){var t=this.text;return this.newLineMode!==f&&(t+="\n"),t}get rawTextLength(){var t=this.text.length;return this.newLineMode===c&&(t+=1),t}get endIndex(){return this.startIndex+this.rawTextLength}get lastX(){return this.x+this.width}},g=s(6);const y=Phaser.Utils.Objects.GetFastValue,v=d.a.NO_NEWLINE;var w=new l.a,x=new l.a;class S{constructor(t){this.pens=[],this.lines=[],this.maxLinesWidth=void 0,this.PensPool=y(t,"pensPool",w),this.LinesPool=y(t,"linesPool",x),this.tagToText=y(t,"tagToText",a.a),this.tagToTextScope=y(t,"tagToTextScope",void 0)}destroy(){this.freePens(),this.tagToText=void 0,this.tagToTextScope=void 0}freePens(){for(var t=0,e=this.lines.length;t<e;t++)this.lines[t].length=0;this.PensPool.pushMultiple(this.pens),this.LinesPool.pushMultiple(this.lines),this.maxLinesWidth=void 0}addPen(t,e,s,n,i,r){var a=this.PensPool.pop();null==a&&(a=new p),T.text=t,T.x=e,T.y=s,T.width=n,T.prop=i,T.newLineMode=r,a.resetFromJSON(T);var o=this.lastPen;a.startIndex=null==o?0:o.endIndex,this.pens.push(a);var h=this.lastLine;null==h&&(h=this.LinesPool.pop()||[],this.lines.push(h)),h.push(a),a.newLineMode!==v&&(h=this.LinesPool.pop()||[],this.lines.push(h)),this.maxLinesWidth=void 0}clone(t){null==t&&(t=new S),t.freePens();for(var e=0,s=this.lines.length;e<s;e++)for(var n=this.lines[e],i=0,r=n.length;i<r;i++){var a=n[i];t.addPen(a.text,a.x,a.y,a.width,Object(g.a)(a.prop),a.newLineMode)}return t}get lastPen(){return this.pens[this.pens.length-1]}get lastLine(){return this.lines[this.lines.length-1]}getLineStartIndex(t){if(t>=this.lines.length)return this.getLineEndIndex(t);var e=this.lines[t];return e[0]?e[0].startIndex:0}getLineEndIndex(t){t>=this.lines.length&&(t=this.lines.length-1);var e,s,n=!1;for(e=t;e>=0&&!(n=null!=(s=this.lines[e])&&s.length>0);e--);return n?s[s.length-1].endIndex:0}getLineWidth(t){var e=this.lines[t];if(!e)return 0;var s=e[e.length-1];return null==s?0:s.lastX}getMaxLineWidth(){if(void 0!==this.maxLinesWidth)return this.maxLinesWidth;for(var t,e=0,s=0,n=this.lines.length;s<n;s++)(t=this.getLineWidth(s))>e&&(e=t);return this.maxLinesWidth=e,e}getLineWidths(){for(var t=[],e=0,s=this.lines.length;e<s;e++)t.push(this.getLineWidth(e));return t}get linesCount(){return this.lines.length}get rawText(){for(var t="",e=this.pens,s=0,n=e.length;s<n;s++)t+=e[s].rawText;return t}get rawTextLength(){for(var t=0,e=this.pens,s=0,n=this.pens.length;s<n;s++)t+=e[s].rawTextLength;return t}getSliceTagText(t,e,s){if(void 0===t&&(t=0),void 0===e){var n=this.lastPen;if(null==n)return"";e=n.endIndex}void 0===s&&(s=!1);for(var i,r,a,o,h,l,d="",u=0,f=this.pens.length;u<f&&((o=(i=this.pens[u]).endIndex)<t||(i=this.pens[u],r=s?i.wrapText:i.rawText,h=i.prop,(a=i.startIndex)>=t&&o<=e||(r=r.substring(t-a,e-a)),this.tagToTextScope?d+=this.tagToText.call(this.tagToTextScope,r,h,l):d+=this.tagToText(r,h,l),l=h,!(o>=e)));u++);return d}}var T={},P=S;Phaser.Utils.GetValue;const m=d.a.NO_NEWLINE,O=d.a.RAW_NEWLINE,k=d.a.WRAPPED_NEWLINE,b=d.a.NO_WRAP,M=d.a.WORD_WRAP,L=(d.a.CHAR_WRAP,d.a.SPLITREGEXP);var C=[],W=new l.a;W.newline=function(t,e,s){var n=this.pop();return null===n&&(n={}),n.text=t,n.width=e,n.newLineMode=s,n};var F=function(t,e,s,n,i){var r=C;if(W.pushMultiple(r),!t||!t.length)return r;for(var a,o,h,l=t.split(L),d=0,u=l.length;d<u;d++)if(a=l[d],h=d===u-1?m:O,s!==b){var f,c;if(o=0===d?n-i:n,a.length<=100&&(S=e(a))<=o){r.push(W.newline(a,S,h));continue}for(var p,g="",y="",v=0,w=0,x=(f=s===M?a.split(" "):a).length;w<x;w++)c=f[w],s===M?(g+=c,w<x-1&&(g+=" ")):g+=c,(p=e(g))>o&&(0===w?r.push(W.newline("",0,k)):(r.push(W.newline(y,v,k)),g=c,s===M&&w<x-1&&(g+=" "),p=e(g)),o=n),y=g,v=p;r.push(W.newline(y,v,h))}else{var S=e(a);r.push(W.newline(a,S,h))}return r};const _=Phaser.Utils.Objects.GetValue,R=(d.a.NO_WRAP,d.a.NO_NEWLINE),z=(d.a.hleft,d.a.hcenter),A=d.a.hright,I=(d.a.vtop,d.a.vcenter),N=d.a.vbottom;var j={},E=class{constructor(t){this.context=_(t,"context",null),this.canvas=this.context.canvas,this.parser=_(t,"parser",null),this.defatultStyle=_(t,"style",null),this.autoRound=!0,this.pensPool=_(t,"pensPool",null),this.pensManager=this.newPenManager(),this._tmpPensManager=null;var e=this.context;this.getTextWidth=function(t){return e.measureText(t).width}}updatePensManager(t,e,s,n,i){if(void 0===i&&(i=this.pensManager),i.freePens(),""===t)return i;for(var r,a,o,h,l,d=this.canvas,u=this.context,f=0,c=0,p=this.parser.splitText(t),y=0,v=p.length;y<v;y++)if(r=(h=this.parser.tagTextToProp(p[y],a)).rawText,a=h.prop,""!==r){this.context.save(),(o=this.parser.propToContextStyle(this.defatultStyle,a)).buildFont(),o.syncFont(d,u),o.syncStyle(d,u);for(var w=0,x=(l=F(r,this.getTextWidth,e,s,f)).length;w<x;w++){var S=l[w];i.addPen(S.text,f,c,S.width,Object(g.a)(a),S.newLineMode),S.newLineMode!==R?(f=0,c+=n):f+=S.width}this.context.restore()}return i}draw(t,e,s,n,i){void 0===i&&(i=this.pensManager);var r=this.context;r.save(),this.drawBackground();var a=this.defatultStyle;t+=a.strokeThickness/2,e+=a.strokeThickness/2+a.metrics.ascent;var o,h,l,d,u,f,c=a.halign,p=a.valign,g=a.lineHeight,y=i.lines,v=y.length,w=a.maxLines;w>0&&v>w?(h=w,l=p===I?Math.floor((v-h)/2):p===N?v-h:0):(h=v,l=0),d=l+h,f=p===I?Math.max((n-h*g)/2,0):p===N?Math.max(n-h*g-2,0):0,f+=e;for(var x=l;x<d;x++)if(0!==(o=i.getLineWidth(x))){u=c===z?(s-o)/2:c===A?s-o:0,u+=t;for(var S=y[x],T=0,P=S.length;T<P;T++)this.drawPen(S[T],u,f)}r.restore()}clear(){var t=this.canvas;this.context.clearRect(0,0,t.width,t.height)}drawBackground(){var t=this.defatultStyle.backgroundColor;if(null!==t){var e=this.context,s=this.canvas;e.fillStyle=t,e.fillRect(0,0,s.width,s.height)}}drawUnderline(t,e,s,n,i){if(!(n<=0)){var r=this.context,a=r.lineCap;r.lineCap="butt",r.beginPath(),r.strokeStyle=i,r.lineWidth=n,r.moveTo(t,e),r.lineTo(t+s,e),r.stroke(),r.lineCap=a}}drawPen(t,e,s){var n=this.canvas,i=this.context;i.save();var r=this.parser.propToContextStyle(this.defatultStyle,t.prop);r.buildFont(),r.syncFont(n,i),r.syncStyle(n,i),e+=t.x,s+=t.y,this.autoRound&&(e=Math.round(e),s=Math.round(s));var a=t.text,o=t.width;this.drawUnderline(e,s+r.underlineOffset,o,r.underlineThickness,r.underlineColor),r.strokeThickness&&(r.syncShadow(i,r.shadowStroke),i.strokeText(a,e,s)),r.color&&"none"!==r.color&&(r.syncShadow(i,r.shadowFill),i.fillText(a,e,s)),i.restore()}destroy(){this.context=void 0,this.canvas=void 0,this.parser=void 0,this.defatultStyle=void 0,this.pensManager.destroy(),this.pensManager=void 0,this._tmpPensManager&&(this._tmpPensManager.destroy(),this._tmpPensManager=void 0)}get lines(){return this.pensManager.lines}get desplayLinesCount(){var t=this.pensManager.linesCount,e=this.defatultStyle.maxLines;return e>0&&t>e&&(t=e),t}get linesWidth(){return this.pensManager.getMaxLineWidth()}get linesHeight(){var t=this.desplayLinesCount,e=this.defatultStyle.lineHeight*t;return t>0&&(e-=this.defatultStyle.lineSpacing),e}newPenManager(){return j.pensPool=this.pensPool,j.tagToText=this.parser.propToTagText,j.tagToTextScope=this.parser,new P(j)}get tmpPenManager(){return null===this._tmpPensManager&&(this._tmpPensManager=this.newPenManager()),this._tmpPensManager}getPlainText(t,e,s){var n;if(null==t)n=this.pensManager.rawText;else{var i=this.parser.splitText(t,1);n="";for(var r=0,a=i.length;r<a;r++)n+=i[r]}return null==e&&null==s||(null==e&&(e=0),null==s&&(s=n.length),n=n.substring(e,s)),n}getPenManager(t,e){if(void 0===t)return this.copyPensManager(e,this.pensManager);void 0===e&&(e=this.newPenManager());var s=this.defatultStyle;return this.updatePensManager(t,s.wrapMode,s.wrapWidth,s.lineHeight,e),e}getText(t,e,s,n){if(null==t)return this.pensManager.getSliceTagText(e,s,n);var i=this.tmpPenManager,r=this.defatultStyle;return this.updatePensManager(t,r.wrapMode,r.wrapWidth,r.lineHeight,i),i.getSliceTagText(e,s,n)}copyPensManager(t,e){return void 0===e&&(e=this.pensManager),e.copy(t)}getTextWidth(t){return void 0===t&&(t=this.pensManager),t.getMaxLineWidth()}getLastPen(t){return void 0===t&&(t=this.pensManager),t.lastPen}};const B=Phaser.DOM.AddToDOM,X=Phaser.Display.Canvas.CanvasPool,G=Phaser.GameObjects.Components,Y=Phaser.GameObjects.GameObject,H=Phaser.Utils.Objects.GetValue,D=Phaser.DOM.RemoveFromDOM,U=d.a.SPLITREGEXP;var V={},J=new Phaser.Class({Extends:Y,Mixins:[G.Alpha,G.BlendMode,G.ComputedSize,G.Crop,G.Depth,G.Flip,G.GetBounds,G.Mask,G.Origin,G.Pipeline,G.ScaleMode,G.ScrollFactor,G.Tint,G.Transform,G.Visible,o],initialize:function(t,e,s,n,i,r,a){if(void 0===e&&(e=0),void 0===s&&(s=0),Y.call(this,t,r),this.renderer=t.sys.game.renderer,this.setPosition(e,s),this.setOrigin(0,0),this.initPipeline(),this.canvas=X.create(this),this.context=this.canvas.getContext("2d"),i&&i.hasOwnProperty("align")){var o=i.align;delete i.align,i.halign=o}this.style=new h.a(this,i),this.autoRound=!0,this._text="",this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.dirty=!1,0===this.style.resolution&&(this.style.resolution=t.sys.game.config.resolution),this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),V.hasOwnProperty(r)||(V[r]=new l.a),q.context=this.context,q.parser=a,q.style=this.style,q.pensPool=V[r],this.canvasText=new E(q),i&&i.padding&&this.setPadding(i.padding),this.setText(n),t.sys.game.config.renderType===Phaser.WEBGL&&t.sys.game.renderer.onContextRestored(function(){this.dirty=!0},this)},text:{set:function(t){this.setText(t)},get:function(){return this._text}},initRTL:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",B(this.canvas,this.scene.sys.canvas),this.originX=1)},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText(!0)),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,s,n,i,r){return this.style.setShadow(t,e,s,n,i,r)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWordWrapWidth:function(t,e){return this.style.setWordWrapWidth(t,e)},setWordWrapCallback:function(t,e){return this.style.setWordWrapCallback(t,e)},setAlign:function(t){return this.style.setHAlign(t)},setLineSpacing:function(t){return this.style.setLineSpacing(t)},setPadding:function(t,e,s,n){if("object"==typeof t){var i=t,r=H(i,"x",null);null!==r?(t=r,s=r):(t=H(i,"left",0),s=H(i,"right",t));var a=H(i,"y",null);null!==a?(e=a,n=a):(e=H(i,"top",0),n=H(i,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===s&&(s=t),void 0===n&&(n=e);return this.padding.left=t,this.padding.top=e,this.padding.right=s,this.padding.bottom=n,this.updateText()},setResolution:function(t){return this.style.setResolution(t)},setMaxLines:function(t){return this.style.setMaxLines(t)},updateText:function(t){void 0===t&&(t=!1);var e=this.canvasText,s=this.style;t&&e.updatePensManager(this._text,s.wrapMode,s.wrapWidth,s.lineHeight);var n=e.linesWidth,i=e.linesHeight,r=this.padding,a=n+r.left+r.right,o=i+r.top+r.bottom;0===s.fixedWidth&&(this.width=a),0===s.fixedHeight&&(this.height=o),this.updateDisplayOrigin();var h=s.resolution;a*=h,o*=h,a=Math.max(Math.ceil(a),1),o=Math.max(Math.ceil(o),1);var l=this.canvas,d=this.context;return l.width!==a||l.height!==o?(l.width=a,l.height=o,this.frame.setSize(a,o)):d.clearRect(0,0,a,o),d.save(),d.scale(h,h),e.draw(r.left,r.top,n,i),d.restore(),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(l,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!0,this},getTextMetrics:function(){return this.style.getTextMetrics()},toJSON:function(){var t=G.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),resolution:this.resolution,padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){this.style.rtl&&D(this.canvas),X.remove(this.canvas),this.canvasText.destroy()},getWrappedText:function(t,e,s){return(t=this.canvasText.getText(t,e,s,!0)).split(U)},getPlainText:function(t,e,s){return this.canvasText.getPlainText(t,e,s)},getText:function(t,e,s){return this.canvasText.getText(t,e,s,!1)},getSubString:function(t,e,s){return this.getText(t,e,s)},copyPensManager:function(t){return this.canvasText.copyPensManager(t)},getPenManager:function(t,e){return this.canvasText.getPenManager(t,e)}}),q={};e.a=J},56:function(t,e,s){"use strict";var n=s(44),i={rawText:null,prevProp:null},r=new(s(24).a);var a=function(t){for(var e,s,n,i={},r=0,a=(t=t.split(";")).length;r<a;r++)if(s=(e=t[r].split(":"))[0],n=e[1],!o(s)&&!o(n)){switch(s){case"stroke":var h=n.split(" ");n={},(d=h.length)>=1&&(n.color=h[0]),d>=2&&(n.thinkness=parseInt(h[1].replace("px","")));break;case"shadow":var l=n.split(" ");n={},(d=l.length)>=1&&(n.color=l[0]),d>=2&&(n.offsetX=parseInt(l[1].replace("px",""))),d>=3&&(n.offsetY=parseInt(l[2].replace("px",""))),d>=4&&(n.blur=parseInt(l[3].replace("px","")));break;case"u":case"underline":var d,u=n.split(" ");n={},(d=u.length)>=1&&(n.color=u[0]),d>=2&&(n.thinkness=parseInt(u[1].replace("px",""))),d>=3&&(n.offset=parseInt(u[2].replace("px","")))}i[s]=n}return i},o=function(t){return 0===(t=t.replace(c,"")).length},h=/<\s*class=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/class\s*\>|<\s*style=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/style\s*\>/g,l=/<\s*class=/i,d=/<\s*class=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/class\s*\>/,u=/<\s*style=/i,f=/<\s*style=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/style\s*\>/,c=/^\s+|\s+$/,p=class{constructor(t){void 0===t&&(t={}),this.tags=t}addTag(t,e){this.tags[t]=e}splitText(t,e){for(var s,n,i,r=[],a=0,o=t.length,c=o;s=h.exec(t);)n=s[0],a<(c=h.lastIndex-n.length)&&r.push(t.substring(a,c)),void 0===e?r.push(n):1===e&&(l.test(n)?(i=n.match(d),r.push(i[2])):u.test(n)&&(i=n.match(f),r.push(i[2]))),a=h.lastIndex;return a<o&&r.push(t.substring(a,o)),r}tagTextToProp(t,e){var s,n;if(l.test(t)){if(null!=(h=t.match(d))){var r=h[1],o=this.tags;(n=o.hasOwnProperty(r)?o[r]:{})._class=r,s=h[2]}}else if(u.test(t)){var h;if(null!=(h=t.match(f))){var c=h[1];(n=a(c))._style=c,s=h[2]}}null==s&&(s=t),null==n&&(n={});var p=i;return p.rawText=s,p.prop=n,p}propToContextStyle(t,e){var s=r;if(e.hasOwnProperty("img"))s.image=e.img;else{if(s.image=null,e.hasOwnProperty("family")||e.hasOwnProperty("fontFamily")||e.hasOwnProperty("font-family")){var n=e.hasOwnProperty("family")?e.family:e.hasOwnProperty("fontFamily")?e.fontFamily:e["font-family"];s.fontFamily=n}else s.fontFamily=t.fontFamily;if(e.hasOwnProperty("size")||e.hasOwnProperty("fontSize")||e.hasOwnProperty("font-size")){var i=e.hasOwnProperty("size")?e.size:e.hasOwnProperty("fontSize")?e.fontSize:e["font-size"];"number"==typeof i&&(i=i.toString()+"px"),s.fontSize=i}else s.fontSize=t.fontSize;if(e.hasOwnProperty("style")||e.hasOwnProperty("fontStyle")||e.hasOwnProperty("font-style")){var a=e.hasOwnProperty("style")?e.style:e.hasOwnProperty("fontStyle")?e.fontStyle:e["font-style"];s.fontStyle=a}else s.fontStyle=t.fontStyle;if(e.hasOwnProperty("color")||e.hasOwnProperty("font-color")?(e.hasOwnProperty("color")?e.color:e["font-color"],s.color=e.color):s.color=t.color,e.hasOwnProperty("stroke")){var o=e.stroke;s.stroke=o.hasOwnProperty("color")?o.color:t.stroke,s.strokeThickness=o.hasOwnProperty("thinkness")?o.thinkness:t.strokeThickness}else s.stroke=t.stroke,s.strokeThickness=t.strokeThickness}if(e.hasOwnProperty("shadow")){var h=e.shadow;s.shadowColor=h.hasOwnProperty("color")?h.color:t.shadowColor,s.shadowOffsetX=h.hasOwnProperty("offsetX")?h.offsetX:t.shadowOffsetX,s.shadowOffsetY=h.hasOwnProperty("offsetY")?h.offsetY:t.shadowOffsetY,s.shadowBlur=h.hasOwnProperty("blur")?h.blur:t.shadowBlur,s.shadowStroke=!0,s.shadowFill=!0}else s.shadowColor=t.shadowColor,s.shadowOffsetX=t.shadowOffsetX,s.shadowOffsetY=t.shadowOffsetY,s.shadowBlur=t.shadowBlur,s.shadowStroke=t.shadowStroke,s.shadowFill=t.shadowFill;if(e.hasOwnProperty("u")||e.hasOwnProperty("underline")){var l=e.hasOwnProperty("u")?e.u:e.underline;s.underlineColor=l.hasOwnProperty("color")?l.color:t.underlineColor,s.underlineThickness=l.hasOwnProperty("thinkness")?l.thinkness:t.underlineThickness,s.underlineOffset=l.hasOwnProperty("offset")?l.offset:t.underlineOffset}else s.underlineColor=t.underlineColor,s.underlineThickness=t.underlineThickness,s.underlineOffset=t.underlineOffset;return s}propToTagText(t,e,s){return e.hasOwnProperty("_class")?""===t&&this.isTextTag(e._class)?"":"<class='"+e._class+"'>"+t+"</class>":e.hasOwnProperty("_style")?"<style='"+e._style+"'>"+t+"</style>":void 0}destroy(){this.tags=void 0}isTextTag(t){var e=this.tags[t];return!!e&&null==e.img}};const g=Phaser.Utils.Objects.GetValue;e.a=class extends n.a{constructor(t,e,s,n,i){var r=g(i,"tags",void 0),a=new p(r);super(t,e,s,n,i,"rexTagText",a),this.parser=a}addTag(t,e){return this.parser.addTag(t,e),this.updateText(!0)}addTags(t){for(var e in t)this.parser.addTag(e,t[e]);return this.updateText(!0)}preDestroy(){super.preDestroy(),this.parser.destroy(),this.parser=void 0}}},6:function(t,e,s){"use strict";var n=s(4);e.a=function(t,e){var s=Array.isArray(t);for(var i in void 0===e?e=s?[]:{}:Object(n.a)(e),s&&(e.length=t.length),t)e[i]=t[i];return e}},9:function(t,e,s){"use strict";e.a=class{constructor(){this.items=[]}pop(){return this.items.length>0?this.items.pop():null}push(t){this.items.push(t)}pushMultiple(t){for(var e=0,s=t.length;e<s;e++)this.items.push(t[e]);t.length=0}}}}).default});